// app/solutions/templates.ts
export type TemplateStep = {
  title: string;
  body?: string;
  /** относительный дедлайн (в днях) от даты создания дела */
  dueInDays?: number;
};

export type TemplateMeta = {
  slug: string;
  title: string;
  category: string; // "Потребитель" и т.д.
  short?: string;
  tags?: string[];
  /** необязательно: подробный markdown по теме */
  bodyMd?: string;
  /** необязательно: предложенные шаги для таймлайна дела */
  steps?: TemplateStep[];
};

export const CATEGORIES: { key: string; title: string }[] = [
  { key: "consumer", title: "Потребитель" },
  { key: "banking", title: "Банки и кредиты" },
  { key: "labor", title: "Труд и работа" },
  { key: "family", title: "Семья" },
  { key: "housing", title: "Жильё и недвижимость" },
  { key: "auto", title: "Авто и транспорт" },
  { key: "taxbiz", title: "Налоги и бизнес" },
  { key: "court", title: "Суды и исполнение" },
  { key: "digital", title: "Цифровые/интеллект" },
  { key: "migration", title: "Миграция и поездки" },
  { key: "social", title: "Соцподдержка" },
];

const MD_DEFAULT = (title: string) =>
  `### Памятка по теме: ${title}

**Когда применимо:** кратко опиши ситуацию, к которой относится это решение.  
**Подготовьте:** договоры, переписку, чеки/квитанции, фото/видео, выписки, заявки/претензии.  
**Алгоритм:**  
1. Зафиксируйте факты и соберите доказательства.  
2. Направьте претензию/заявление по шаблону.  
3. Дождитесь ответа в установленные сроки.  
4. При отказе — жалоба/эскалация/иск.  
**Куда обращаться:** контролирующие органы/суд.  
**Ошибки:** пропуск сроков, нет доказательств, «устные договорённости».  
**Правовая база:** ГК/ЗоЗПП/ТК/НК и иные спец-акты по ситуации.
`;

export const ALL_TEMPLATES: TemplateMeta[] = [
  // ---------- Потребитель (12)
  { slug:"vozvrat-14-dney", title:"Возврат товара ненадлежащего качества (14 дней/гарантия)", category:"Потребитель", tags:["возврат","товар","гарантия"], short:"Как вернуть покупку и получить деньги/обмен" },
  { slug:"vozvrat-internet", title:"Возврат дистанционной покупки (интернет-магазин/маркетплейс)", category:"Потребитель", tags:["маркетплейс","онлайн"], short:"Правила и сроки для онлайн-заказов" },
  { slug:"garantiynyi-remont", title:"Претензия по гарантийному ремонту: сроки, неустойка", category:"Потребитель", tags:["сервис","ремонт","неустойка"] },
  { slug:"prosrochka-dostavki", title:"Просрочка доставки — взыскание неустойки", category:"Потребитель", tags:["доставка","курьер"] },
  { slug:"navyazannaya-usluga", title:"Навязанная услуга — отказ и возврат денег", category:"Потребитель", tags:["навязанные услуги","допуслуги"] },
  { slug:"net-cheka", title:"Нет чека — как защищаться и куда жаловаться", category:"Потребитель", tags:["чек","доказательства"] },
  { slug:"sertifikaty-abonementy", title:"Подарочные сертификаты/абонементы — возврат средств", category:"Потребитель", tags:["сертификат","абонемент"] },
  { slug:"tyanut-remont", title:"Ремонт тянется в сервисе — как воздействовать", category:"Потребитель", tags:["сервис","сроки"] },
  { slug:"podpiski-spisaniya", title:"Платные подписки/автосписания — отмена и возврат", category:"Потребитель", tags:["подписка","возврат"] },
  { slug:"svyaz-internet", title:"Связь/интернет работает плохо — претензия, перерасчёт", category:"Потребитель", tags:["связь","интернет","перерасчёт"] },
  { slug:"turizm-otmena", title:"Туристические услуги/отмена тура — возврат, перенос", category:"Потребитель", tags:["туризм","возврат"] },
  { slug:"marketplaces-spor", title:"Маркетплейс: спор с продавцом/площадкой", category:"Потребитель", tags:["маркетплейс","спор"] },

  // ---------- Банки и кредиты (12)
  { slug:"momo-spisaniya", title:"Оспаривание мошеннических списаний/переводов", category:"Банки и кредиты", tags:["чарджбек","мошенники"], short:"Как зафиксировать и вернуть деньги" },
  { slug:"vozvrat-strahovki-po-kreditu", title:"Возврат навязанной страховки при кредите", category:"Банки и кредиты", tags:["страховка","кредит"] },
  { slug:"dosrochnoe-pogashenie", title:"Досрочное погашение: заявление и перерасчёт", category:"Банки и кредиты", tags:["досрочное","проценты"] },
  { slug:"restrukturizaciya", title:"Реструктуризация долга: варианты и как просить", category:"Банки и кредиты", tags:["реструктуризация","долг"] },
  { slug:"kreditnye-kanikuly", title:"Кредитные каникулы: условия и пакет бумаг", category:"Банки и кредиты", tags:["каникулы","льготы"] },
  { slug:"aresty-fssp-scheta", title:"Аресты/ограничения ФССП на счетах — как снять", category:"Банки и кредиты", tags:["ФССП","арест","счёт"] },
  { slug:"neprav-komissii", title:"Неправомерные комиссии — претензия банку", category:"Банки и кредиты", tags:["комиссия","претензия"] },
  { slug:"bki-istoriya", title:"Исправление кредитной истории: запросы в БКИ", category:"Банки и кредиты", tags:["БКИ","история"] },
  { slug:"oshibki-vypiska", title:"Ошибки в выписке — урегулирование", category:"Банки и кредиты", tags:["выписка","ошибка"] },
  { slug:"ipoteka-kanikuly", title:"Ипотечные каникулы/льготы для семей", category:"Банки и кредиты", tags:["ипотека","семья"] },
  { slug:"vozvrat-strahovki-posle-zakrytiya", title:"Возврат страховки после закрытия кредита", category:"Банки и кредиты", tags:["страховка","возврат"] },
  { slug:"zakryt-kredit", title:"Как закрыть кредит и получить «ноль»", category:"Банки и кредиты", tags:["закрытие","справка"] },

  // ---------- Труд (10)
  { slug:"uvolnenie-sobstvennoe", title:"Увольнение по собственному — безопасный чек-лист", category:"Труд и работа", tags:["увольнение"] },
  { slug:"sokrashchenie", title:"Сокращение штата — выплаты, права, сроки", category:"Труд и работа", tags:["сокращение"] },
  { slug:"nevyplata-zp", title:"Невыплата зарплаты — жалобы, иск, проценты", category:"Труд и работа", tags:["зарплата","задержка"] },
  { slug:"sverhurochka", title:"Переработки/сверхурочка — доказательства и компенсация", category:"Труд и работа", tags:["переработка","компенсация"] },
  { slug:"otpusk", title:"Отпуск: перенос, отзыв, компенсация деньгами", category:"Труд и работа", tags:["отпуск"] },
  { slug:"bolnichnyj", title:"Больничный: оформление, оплата, споры", category:"Труд и работа", tags:["больничный"] },
  { slug:"udalenka", title:"Удалёнка: условия, изменения, дисциплина", category:"Труд и работа", tags:["удалёнка"] },
  { slug:"gph-vmesto-truda", title:"ГПХ вместо трудового — как защититься", category:"Труд и работа", tags:["ГПХ","подмена"] },
  { slug:"mat-otvetstvennost", title:"Матответственность работника — как оспорить", category:"Труд и работа", tags:["матответственность"] },
  { slug:"vygovor", title:"Выговор/взыскание — как снять", category:"Труд и работа", tags:["взыскание"] },

  // ---------- Семья (10)
  { slug:"razvod", title:"Развод: ЗАГС или суд — пошагово", category:"Семья", tags:["развод"], bodyMd: MD_DEFAULT("Развод") },
  { slug:"razdel-imushchestva", title:"Раздел имущества супругов", category:"Семья", tags:["имущество"] },
  { slug:"alimenty", title:"Алименты: назначение/изменение/взыскание", category:"Семья", tags:["алименты"] },
  { slug:"mesto-zhitelstva-rebenka", title:"Определение места жительства ребёнка", category:"Семья", tags:["ребёнок"] },
  { slug:"grafik-obshcheniya", title:"График общения с ребёнком — соглашение/суд", category:"Семья", tags:["график","общение"] },
  { slug:"brachnyi-dogovor", title:"Брачный договор: составление/изменение", category:"Семья", tags:["брачный договор"] },
  { slug:"otcovstvo", title:"Установление/оспаривание отцовства", category:"Семья", tags:["отцовство"] },
  { slug:"vyiezd-rebenka", title:"Выезд ребёнка за границу — согласия/запреты", category:"Семья", tags:["выезд"] },
  { slug:"smena-familii-rebenka", title:"Смена фамилии ребёнка — порядок", category:"Семья", tags:["фамилия"] },
  { slug:"semeynaya-ipoteka-razvod", title:"Ипотека и «семейная» квартира при разводе", category:"Семья", tags:["ипотека","развод"] },

  // ---------- Жильё (12)
  { slug:"registraciya-prava", title:"Регистрация права собственности", category:"Жильё и недвижимость", tags:["росреестр","регистрация"] },
  { slug:"pokupka-vtorichki", title:"Покупка «вторички»: проверка чистоты", category:"Жильё и недвижимость", tags:["сделка","проверка"] },
  { slug:"doli-vydel", title:"Доли и выдел долей: соглашения, нотариус", category:"Жильё и недвижимость", tags:["доли"] },
  { slug:"spor-uk-tszh", title:"Спор с ТСЖ/УК: начисления, качество, перерасчёт", category:"Жильё и недвижимость", tags:["ТСЖ","УК"] },
  { slug:"pereplanirovka", title:"Перепланировка: согласовать/узаконить", category:"Жильё и недвижимость", tags:["перепланировка"] },
  { slug:"privatizaciya", title:"Приватизация: условия и документы", category:"Жильё и недвижимость", tags:["приватизация"] },
  { slug:"arenda-zhilya", title:"Аренда жилья: договор, залог, выселение", category:"Жильё и недвижимость", tags:["аренда"] },
  { slug:"zaderzhka-novostroyki", title:"Задержка сдачи новостройки — неустойка", category:"Жильё и недвижимость", tags:["дольщик","неустойка"] },
  { slug:"samostroy", title:"Самострой/гаражи: узаконить или снос", category:"Жильё и недвижимость", tags:["самострой"] },
  { slug:"zemlya-granicy", title:"Земельные споры: границы, межевание, сервитут", category:"Жильё и недвижимость", tags:["земля","границы"] },
  { slug:"shumnye-sosedi", title:"Шумные соседи/залив — жалобы и компенсация", category:"Жильё и недвижимость", tags:["соседи","залив"] },
  { slug:"perevod-v-nezhiloe", title:"Перевод жилого в нежилое (и обратно)", category:"Жильё и недвижимость", tags:["перевод","назначение"] },

  // ---------- Авто (8)
  { slug:"dtp-evroprotokol", title:"ДТП без пострадавших: европротокол и страховая", category:"Авто и транспорт", tags:["ДТП","европротокол"] },
  { slug:"dtp-postradavshie", title:"ДТП с пострадавшими: как действовать", category:"Авто и транспорт", tags:["ДТП","уголовное"] },
  { slug:"osago-otkaz", title:"ОСАГО/КАСКО отказ — досудебка и иск", category:"Авто и транспорт", tags:["ОСАГО","КАСКО"] },
  { slug:"pokupka-avto", title:"Покупка авто: проверка и договор", category:"Авто и транспорт", tags:["покупка","ДКП"] },
  { slug:"shtrafy-obzhalovat", title:"Штрафы ГИБДД: как проверить и обжаловать", category:"Авто и транспорт", tags:["штрафы"] },
  { slug:"lishenie-prav", title:"Лишение прав/медосвидетельствование — защита", category:"Авто и транспорт", tags:["лишение","медосвидетельствование"] },
  { slug:"spor-s-dilerom", title:"Спор с дилером/сервисом: гарантия, дефекты", category:"Авто и транспорт", tags:["дилер","гарантия"] },
  { slug:"transportnyi-nalog", title:"Транспортный налог и запреты приставов", category:"Авто и транспорт", tags:["налог","ФССП"] },

  // ---------- Налоги и бизнес (12)
  {
    slug:"otkryt-ip",
    title:"Открыть ИП/самозанятого: шаги, налоги, ЭЦП",
    category:"Налоги и бизнес",
    tags:["ИП","самозанятый","регистрация"],
    short:"Проверено: быстро и без ошибок",
    bodyMd:
`### Открыть ИП: пошагово

1) Определите режим налогообложения (УСН 6% или 15%).  
2) Подготовьте паспорт, ИНН, СНИЛС, телефон/почту.  
3) Выпустите ЭЦП (или через Госуслуги без ЭЦП, если доступно).  
4) Заполните заявление Р21001 (онлайн в ФНС).  
5) Подайте уведомление о выборе УСН.  
6) Откройте расчётный счёт, подключите онлайн-кассу при необходимости.  

**Срок:** 1–3 рабочих дня.  
**Ошибки:** неверный ОКВЭД, забыли УСН.  
**Дальше:** учёт доходов, отчётность, взносы.`,
    steps:[
      { title:"Выбрать режим налогообложения (УСН)", dueInDays:1 },
      { title:"Подать Р21001 онлайн", dueInDays:2 },
      { title:"Подать уведомление о применении УСН", dueInDays:3 },
      { title:"Открыть расчётный счёт", dueInDays:5 },
    ]
  },
  { slug:"vybor-naloga", title:"Выбор системы налогообложения (УСН/ПСН/НПД)", category:"Налоги и бизнес", tags:["УСН","ПСН","НПД"] },
  { slug:"registraciya-ooo", title:"Регистрация ООО: устав, адрес, счёт", category:"Налоги и бизнес", tags:["ООО","регистрация"] },
  { slug:"zakrytie-ip-ooo", title:"Закрытие ИП/ООО: ликвидация и отчётность", category:"Налоги и бизнес", tags:["ликвидация","закрытие"] },
  { slug:"online-kassa", title:"Онлайн-касса (54-ФЗ): когда нужна, как подключить", category:"Налоги и бизнес", tags:["касса","54-ФЗ"] },
  { slug:"vychety", title:"Налоговые вычеты: имущественный/социальный/инвест", category:"Налоги и бизнес", tags:["вычеты"] },
  { slug:"samozanyatyy", title:"Самозанятый: как платить и отчитываться", category:"Налоги и бизнес", tags:["НПД","самозанятый"] },
  { slug:"nalogovaya-proverka", title:"Налоговая проверка: камеральная/выездная", category:"Налоги и бизнес", tags:["проверка","ФНС"] },
  { slug:"115-fz", title:"Блокировка по 115-ФЗ: как снять", category:"Налоги и бизнес", tags:["115-ФЗ","блокировка"] },
  { slug:"dogovor-uslugi", title:"Договор подряда/оказания услуг — чек-лист", category:"Налоги и бизнес", tags:["договор","подряд"] },
  { slug:"arenda-kommercheskaya", title:"Коммерческая аренда: договор, залог, индексация", category:"Налоги и бизнес", tags:["аренда","коммерческая"] },
  { slug:"tovarnyi-znak", title:"Товарный знак: регистрация и защита", category:"Налоги и бизнес", tags:["Роспатент","бренд"] },

  // ---------- Суд и исполнение (8)
  { slug:"isk-online", title:"Подать иск онлайн (ГАС «Правосудие»)", category:"Суды и исполнение", tags:["иск","ГАС"] },
  { slug:"sudebnyi-prikaz", title:"Судебный приказ: получить/отменить", category:"Суды и исполнение", tags:["приказ"] },
  { slug:"neustoika-vzyskat", title:"Взыскать неустойку/штраф/моральный вред", category:"Суды и исполнение", tags:["неустойка","штраф"] },
  { slug:"ispolnitelnoe-proizvodstvo", title:"Исполнительное производство: запустить/закончить", category:"Суды и исполнение", tags:["ФССП","исполнение"] },
  { slug:"snyat-aresty", title:"Снять аресты и запреты у приставов", category:"Суды и исполнение", tags:["арест","запрет"] },
  { slug:"zaochnoye-reshenie", title:"Заочное решение — как отменить", category:"Суды и исполнение", tags:["заочное"] },
  { slug:"obzhalovat-koap", title:"Обжаловать постановление по КоАП", category:"Суды и исполнение", tags:["КоАП","жалоба"] },
  { slug:"mirovoe-soglashenie", title:"Мировое соглашение: когда выгодно и как оформить", category:"Суды и исполнение", tags:["мировое"] },

  // ---------- Цифровые/интеллект (8)
  { slug:"kibermoshenniki", title:"Кибермошенничество: возврат денег, заявления", category:"Цифровые/интеллект", tags:["мошенничество","кибер"] },
  { slug:"pd-roskomnadzor", title:"Персональные данные: жалоба в Роскомнадзор", category:"Цифровые/интеллект", tags:["ПДн"] },
  { slug:"kleveta-udalenie", title:"Удаление клеветы/контента — законный путь", category:"Цифровые/интеллект", tags:["удаление","жалоба"] },
  { slug:"avtorskoe-pravo", title:"Авторские права онлайн: претензия/блокировка", category:"Цифровые/интеллект", tags:["авторское","контент"] },
  { slug:"dogovor-bloger", title:"Договор с блогером/агентством — чек-лист", category:"Цифровые/интеллект", tags:["инфлюенс","договор"] },
  { slug:"marketplace-кошельки", title:"Маркетплейсы/кошельки: спор и эскалация", category:"Цифровые/интеллект", tags:["кошелёк","спор"] },
  { slug:"ban-akkaunta", title:"Аккаунт заблокировали: апелляция", category:"Цифровые/интеллект", tags:["бан","апелляция"] },
  { slug:"domeny-spory", title:"Доменные споры/киберсквоттинг", category:"Цифровые/интеллект", tags:["домен"] },

  // ---------- Миграция (6)
  { slug:"zagran-vizy", title:"Загранпаспорт/визы: пошагово", category:"Миграция и поездки", tags:["загран","виза"] },
  { slug:"reg-po-mestu-prebyvaniya", title:"Регистрация по месту пребывания (иностранец)", category:"Миграция и поездки", tags:["регистрация"] },
  { slug:"patent-rabota", title:"Патент/разрешение на работу", category:"Миграция и поездки", tags:["патент"] },
  { slug:"rvp-vnzh", title:"РВП/ВНЖ: основания и документы", category:"Миграция и поездки", tags:["РВП","ВНЖ"] },
  { slug:"grazhdanstvo", title:"Гражданство РФ: типовые сценарии", category:"Миграция и поездки", tags:["гражданство"] },
  { slug:"migracionnye-shtrafy", title:"Штрафы за миграционные нарушения — как оспорить", category:"Миграция и поездки", tags:["штраф","миграция"] },

  // ---------- Соцподдержка (2)
  { slug:"posobiya-rozhdenie", title:"Пособия при рождении/уходе за ребёнком", category:"Соцподдержка", tags:["пособия"] },
  { slug:"pensiya-lgoty", title:"Пенсия/льготы — как оформить", category:"Соцподдержка", tags:["пенсия","льготы"] },
];

// Небольшая «заготовка» для тех карточек, где bodyMd не указан
export function getTemplateBody(slug: string, title: string): string {
  const t = ALL_TEMPLATES.find(x => x.slug === slug);
  return (t?.bodyMd && t.bodyMd.trim()) ? t.bodyMd : MD_DEFAULT(title);
}

export function getByCategory(catTitle: string): TemplateMeta[] {
  return ALL_TEMPLATES.filter(t => t.category === catTitle);
}
