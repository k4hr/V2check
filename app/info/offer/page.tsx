/* path: app/info/offer/page.tsx */
import React from 'react';
import Link from 'next/link';
import type { Metadata } from 'next';
import BackBtn from '@/components/BackBtn';
import { PRICES, type Plan, type Tier, getPriceFor } from '@/lib/pricing';

export const metadata: Metadata = {
  title: 'Публичная оферта — LiveManager',
  description: 'Публичная оферта на оказание услуг сервиса LiveManager',
};

const TIERS: Tier[] = ['PRO', 'PROPLUS'];
const PLANS: Plan[] = ['WEEK', 'MONTH', 'HALF_YEAR', 'YEAR'];

function fmtXTR(n: number) {
  return `${n.toLocaleString('ru-RU')} XTR`;
}
function fmtRUB(kopecks: number) {
  const rub = kopecks / 100;
  return new Intl.NumberFormat('ru-RU', {
    style: 'currency',
    currency: 'RUB',
    maximumFractionDigits: 0,
  }).format(rub);
}

export default function OfferPage() {
  return (
    <main className="lm-page" style={{ maxWidth: 900 }}>
      <div style={{ position: 'relative', marginBottom: 6 }}>
        <BackBtn fallback="/cabinet" />
      </div>

      <h1>Публичная оферта на оказание услуг LiveManager</h1>
      <p className="lm-subtitle">Редакция от 01.11.2025</p>

      <p>
        Настоящий документ является публичной офертой («Оферта») в соответствии со
        статьёй 437 ГК РФ и определяет условия предоставления доступа к
        функционалу сервиса LiveManager («Сервис», «Исполнитель») пользователям
        («Пользователь»).
      </p>

      <h2>1. Термины</h2>
      <ul>
        <li>
          <b>Сервис (LiveManager)</b> — онлайн-инструменты и чат-ассистент на базе ИИ,
          доступные через мини-приложение Telegram и веб-интерфейс.
        </li>
        <li>
          <b>Аккаунт</b> — учётная запись, создаваемая посредством авторизации в Telegram или на сайте.
        </li>
        <li>
          <b>Подписка</b> — платный доступ к расширенным возможностям (Pro/Pro+).
        </li>
        <li>
          <b>Контент</b> — тексты и изображения, сгенерированные ИИ по запросу Пользователя.
        </li>
      </ul>

      <h2>2. Предмет Оферты</h2>
      <p>
        Исполнитель предоставляет Пользователю доступ к функционалу Сервиса, включая
        базовые и платные возможности по модели подписки, а Пользователь обязуется
        соблюдать условия Оферты и оплачивать Подписку (при её оформлении).
      </p>

      <h2>3. Акцепт Оферты</h2>
      <p>
        Договор считается заключённым с момента: (1) оплаты Подписки; (2) начала
        использования Сервиса; (3) явного подтверждения согласия в интерфейсе.
      </p>

      <h2>4. Регистрация и доступ</h2>
      <ul>
        <li>Авторизация осуществляется через Telegram WebApp или сайт.</li>
        <li>Пользователь несёт ответственность за доступ к своему аккаунту.</li>
      </ul>

      <h2>5. Стоимость, оплата и продление</h2>
      <ul>
        <li>
          Актуальные тарифы опубликованы в интерфейсе Сервиса и в Приложении 1.
          Изменения стоимости не затрагивают уже оплаченный период.
        </li>
        <li>
          Оплата осуществляется через платёжные провайдеры (в т.ч. YooKassa).
          Данные банковских карт хранятся исключительно у провайдеров.
        </li>
        <li>
          Подписка может продлеваться автоматически, если автопродление активировано.
          Отменить его можно в интерфейсе провайдера или через поддержку Сервиса.
        </li>
      </ul>

      <h3>5.1. Пробный период 1 ₽ и рекуррентные списания</h3>
      <ul>
        <li>
          При выборе «Пробный день 1 ₽» первый платёж составляет 1 ₽.
          Оформляя пробный период, Пользователь соглашается на сохранение способа
          оплаты у провайдера и последующие рекуррентные списания.
        </li>
        <li>
          Первое списание после пробного периода происходит через 24 часа и
          составляет стоимость месячного тарифа <b>без учёта скидок</b>,
          действующих в момент старта пробного периода.
        </li>
        <li>
          Далее списания выполняются ежемесячно до момента отмены.
          Отменить автопродление можно до даты списания: (а) в интерфейсе провайдера,
          либо (б) через поддержку Сервиса — указав Telegram ID и фразу «Отмена подписки».
        </li>
        <li>
          После отмены доступ сохраняется до конца уже оплаченного периода.
        </li>
      </ul>

      <h3>5.2. Согласие на off-session списания</h3>
      <p>
        Оформляя подписку/пробный период, Пользователь даёт согласие на повторные
        списания без дополнительного подтверждения (off-session) с сохранённого
        способа оплаты. Согласие можно отозвать отменой автопродления.
      </p>

      <h2>6. Возвраты и претензии</h2>
      <ul>
        <li>
          Возврат возможен в случаях: двойного списания, технической невозможности
          предоставить доступ более 24 часов подряд, либо в иных случаях,
          предусмотренных законом.
        </li>
        <li>Претензия рассматривается в течение 10 рабочих дней.</li>
      </ul>

      <h2>7. Ограничения использования</h2>
      <ul>
        <li>
          Запрещается нарушать права третьих лиц, обходить лимиты, использовать
          Сервис в противоправных целях, копировать или распространять его части.
        </li>
        <li>Контент ИИ может содержать неточности — Пользователь оценивает его самостоятельно.</li>
      </ul>

      <h2>8. Интеллектуальная собственность</h2>
      <ul>
        <li>
          Пользователю предоставляется неисключительная лицензия на использование
          Сервиса и созданного контента.
        </li>
        <li>Правообладателем Сервиса является Исполнитель.</li>
      </ul>

      <h2>9. Персональные данные</h2>
      <p>
        Обработка данных осуществляется согласно{' '}
        <Link href="/info/privacy">Политике конфиденциальности</Link>.
      </p>

      <h2>10. Ответственность</h2>
      <ul>
        <li>Сервис предоставляется «как есть».</li>
        <li>Исполнитель не несёт ответственности за сбои провайдеров, Telegram, форс-мажор.</li>
      </ul>

      <h2>11. Форс-мажор</h2>
      <p>
        Стороны освобождаются от ответственности при наступлении обстоятельств
        непреодолимой силы.
      </p>

      <h2>12. Срок действия и расторжение</h2>
      <ul>
        <li>Оферта действует бессрочно до её отзыва.</li>
        <li>Пользователь может прекратить использование в любое время.</li>
      </ul>

      <h2>13. Применимое право и споры</h2>
      <p>Применяется право РФ. Споры решаются в претензионном порядке, затем в суде.</p>

      <h2>14. Контакты</h2>
      <ul>
        <li>Исполнитель: <b>LiveManager</b></li>
        <li>Поддержка: <b>@seimngr</b></li>
        <li>ИНН: <b>290221242314</b></li>
        <li>ОГРНИП: <b>325290000042402</b></li>
      </ul>

      {/* Приложение 1 — тарифы */}
      <h2 style={{ marginTop: 32 }}>Приложение 1. Тарифы и стоимость</h2>
      <p>
        Цены подтягиваются из <code>lib/pricing.ts</code>.  
        Для Telegram оплата производится в <b>Stars (XTR)</b>.
      </p>

      {TIERS.map((tier) => (
        <section key={tier} style={{ marginTop: 18 }}>
          <h3>{tier === 'PRO' ? 'Тариф «Pro»' : 'Тариф «Pro+»'}</h3>
          <div style={{ overflowX: 'auto', border: '1px solid var(--card-border)', borderRadius: 12 }}>
            <table style={{ width: '100%', borderCollapse: 'collapse' }}>
              <thead>
                <tr style={{ background: 'rgba(255,255,255,.04)' }}>
                  <th style={th}>Период</th>
                  <th style={th}>Описание</th>
                  <th style={th}>Telegram (XTR)</th>
                </tr>
              </thead>
              <tbody>
                {PLANS.map((plan) => {
                  const base = PRICES[tier][plan];
                  const tg = getPriceFor(tier, plan, 'TG');
                  return (
                    <tr key={plan}>
                      <td style={td}><b>{base.label}</b></td>
                      <td style={td}>{base.description}</td>
                      <td style={td}>{fmtXTR(tg.amount)}</td>
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>
        </section>
      ))}

      <p style={{ marginTop: 12, opacity: .8 }}>
        Примечание: цены могут меняться. Обновления публикуются в интерфейсе.
      </p>

      <p style={{ marginTop: 24 }}>
        Актуальная редакция Оферты: <Link href="/info/offer">/info/offer</Link>
      </p>
    </main>
  );
}

const th: React.CSSProperties = {
  textAlign: 'left',
  padding: '10px 12px',
  borderBottom: '1px solid var(--card-border)',
  whiteSpace: 'nowrap',
};
const td: React.CSSProperties = {
  padding: '10px 12px',
  borderBottom: '1px solid var(--card-border)',
  verticalAlign: 'top',
};
